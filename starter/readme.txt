=======================================================================================================
Краткое руководство по развертыванию проекта на базе Energine
=======================================================================================================

Предисловие:

Начиная с версии energine 2.11.0 структура проекта изменилась.
Теперь релизы ядра energine могут храниться в отдельной директории (например /var/www/energine).

А сами проекты теперь больше не тянут ядро и модули через svn:externals, а подключают нужные версии модулей
ядра и сторонние модули через указанные местоположения в конфиге.

Итак, для того, чтобы развернуть проект на базе energine у себя, необходимо:

1. Создать директорию для хранения ядер (например /var/www/energine)

Пример:
mkdir /var/www/energine

2. Разархивировать дистрибутив с ядром или извлечь из svn одно из стабильных ядер
(начиная с версии tags/2.11.8 или trunk)

Пример извлечения стабильного релиза и trunk версии:
cd /var/www/energine
svn checkout https://energine.googlecode.com/svn/tags/2.11.8 2.11.8
svn checkout https://energine.googlecode.com/svn/trunk trunk

3. Извлечь из svn проект starter из одного из стабильных релизов проекта, либо bleeding-edge релиз из trunk:

Пример:
cd /home/username/projects
svn checkout https://energine.googlecode.com/svn/tags/2.11.8/starter www.mynewsite.com

4. Далее необходимо создать базу данных mysql

4.1. импортировать базовую структуру из sql/starter.structure.sql
4.2. импортировать хранимые процедуры из sql/starter.routines.sql
4.3. импортировать системные данные из sql/starter.data.sql

5. Скопировать конфигурационный файл из configs/system.config.default.php в configs/system.config.username.php,
а затем сделать симлинк из configs/system.config.username.php в htdocs/system.config.php

6. Отредактировать конфигурационный файл, по крайней мере ввести туда такие данные:
- указать директорию с текущим ядром, откуда будут браться setup и core/modules,
- задать корректные настройки базы данных,
- указать домен сайта,
- задать перечень модулей, которые будут доступны на сайте, с указанием полного пути к месторасположению каждого модуля,
- заменить адреса электронной почты на свои.

7. Настроить веб-сервер (nginx+php_fpm или apache2+mod_php)

7.1. Настройка nginx:
Базовый конфиг nginx находится в jambalaya/.nginx.conf.example
Данный конфиг можно скопировать в папку conf.d конфигурации nginx в виде conf файла, например www.mysite.com.conf

7.1.1. в блоке upstream php-fpm необходимо указать способ подключения к php-fpm.
В примере указано подключение через socket
7.1.2. в блоке server необходимо задать правильный server_name и порт директивой listen
7.1.3. в блоке server необходимо задать абсолютный путь к проекту в переменной $www_folder

После этого nginx готов - можно перезапускать php-fpm и nginx и наслаждаться только что созданным проектом

7.2. Настройка apache2:
Базовый конфиг apache находится в jambalaya/.htaccess
Подразумевается, что VirtualHost уже настроен, поэтому вся дальнейшая настройка касается
исключительно модуля mod_rewrite:

7.2.1. Данный конфиг необходимо скопировать в директорию www.mysite.com/htdocs/
7.2.2. Исправить единственную директиву RewriteBase. В случае, если проект находится в папке,
а не в корне сайта - директива пример вид RewriteBase /~username/some/folder/.
В случае, если сайт находится в корне - оставить без изменений RewriteBase /

8. Выставить права на запись на директорию htdocs/uploads
(а также на htdocs, htdocs/core/modules в случае использования apache) и запустить http://<адрес проекта>/setup/
Если все пойдет как нужно - у Вас будет минимально-рабочая копия системы на базе движка Energine.

9. Разработать сайт на базе Energine ;)

10. Убрать права на запись для директории htdocs и htdocs/core/modules (в случае использования apache)

11. Выключить debug режим в конфигурационном файле перед выкладыванием на production

=======================================================================================================
(c) 2013 Energine Team
=======================================================================================================
